define(["../cms-login.js"],function(_cmsLogin){"use strict";var _marked=/*#__PURE__*/regeneratorRuntime.mark(generateData);function _templateObject_77ef8f30615e11eab834b97a903770ac(){var data=babelHelpers.taggedTemplateLiteral(["\n        <dom-repeat repeat items=\"[[inform]]\" as=\"cat\">\n            <template>\n                <div class=\"center-menu\">\n                    <aside class=\"info\">\n                        <span>\n                            [[info]]\n                        </span>\n                    </aside>\n                </div>\n                <div class=\"row-menu\">\n                    <aside>\n                        <span>\n                            [[publishedby]]\n                        </span>\n                    </aside>.str\n                    <aside>\n                        <span>\n                            [[publiShed]]\n                        </span>\n                    </aside>\n                    <aside>\n                        <span>\n                            [[datepublished]]\n                        </span>\n                    </aside>\n                </div>\n                <div class=\"center-menu\">\n                    <aside class=\"asideBackgrc\">\n                        <span>\n                            [[cat.Published.publishedBy]]\n                        </span>\n                    </aside>\n                    <aside class=\"asideBackgrc\" published$=\"[[cat.Published.state]]\">\n                        <span>\n                            [[cat.Published.state]]\n                        </span>\n                    </aside>\n                    <aside class=\"asideBackgrc\">\n                        <span>\n                            [[cat.Published.date]]\n                        </span>\n                    </aside>\n                </div>\n                <div class=\"row-menu\">\n                    <aside>\n                        <span>\n                            [[author]]\n                        </span>\n                    </aside>\n                    <aside>\n                        <span>\n                            [[datecreated]]\n                        </span>\n                    </aside>\n                </div>\n                <div class=\"center-menu\">\n                    <aside class=\"asideBackgrc\">\n                        <span>\n                            [[cat.author.name]]\n                        </span>\n                    </aside>\n                    <aside class=\"asideBackgrc\">\n                        <span>\n                            [[cat.dateCreated]]\n                        </span>\n                    </aside>\n                </div>\n\n                <div class=\"center-menu\">\n                    <aside>\n                        <span>\n                            [[lastmodified]]\n                        </span>\n                    </aside>\n                </div>\n                <div class=\"row-menu\">\n                    <aside>\n                        <span>\n                            [[author]]\n                        </span>\n                    </aside>\n                    <aside>\n                        <span>\n                            [[date]]\n                        </span>\n                    </aside>\n                </div>\n                <div rightSide>\n                    <dom-repeat repeat items=\"[[cat.lastModified]]\" as=\"mod\">\n                        <template>\n                            <section>\n                                <aside class=\"asideBackgrc\">\n                                    <span>\n                                        [[mod.author]]\n                                    </span>\n                                </aside>\n                                <aside class=\"asideBackgrc\">\n                                    <span>\n                                        [[mod.date]]\n                                    </span>\n                                </aside>\n                            </section>\n                        </template>\n                    </dom-repeat>\n                </div>\n            </template>\n        </dom-repeat>"]);_templateObject_77ef8f30615e11eab834b97a903770ac=function _templateObject_77ef8f30615e11eab834b97a903770ac(){return data};return data}var Modelo="eyJpbWFnZXMiOnsiY29udGVudCI6W119LCJsYW5nIjp7ImNhdGVnb3J5TmFtZSI6IiJ9fQ==",ModeloInfo="W3siUHVibGlzaGVkIjp7ImRhdGUiOiIiLCJwdWJsaXNoZWRCeSI6Ik4vQSIsInN0YXRlIjoiTi9QIn0sImF1dGhvciI6eyJpZCI6IiIsIm5hbWUiOiIifSwiZGF0ZUNyZWF0ZWQiOiIiLCJpZCI6IiIsInN1YkNhdGVnb3J5Q291bnQiOiIiLCJ0b0FydGljbGUiOmZhbHNlLCJ0eXBlIjoiIiwibGFzdE1vZGlmaWVkIjpbXX1d",cmsPageCatsContent=/*#__PURE__*/function(_cmsPagesLib){babelHelpers.inherits(cmsPageCatsContent,_cmsPagesLib);function cmsPageCatsContent(){babelHelpers.classCallCheck(this,cmsPageCatsContent);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(cmsPageCatsContent).apply(this,arguments))}babelHelpers.createClass(cmsPageCatsContent,[{key:"ready",value:function ready(){var _this=this;babelHelpers.get(babelHelpers.getPrototypeOf(cmsPageCatsContent.prototype),"ready",this).call(this);this.translator.target("cms-page-list-type-content","setLangObject",this._setLObj.bind(this));this.translator.target("cms-page-list-type-content","changeLang",this._setLang.bind(this),/* ignoreName */ /* ignoreName */!1/* skipSlots */ /* skipSlots */);this.translator.shoot("cms-page-list-type-content","setLangObject");this.$.image.addImage=this.addImage.bind(this);var form=this.shadowRoot.querySelectorAll("iron-form");form.forEach(function(form){return form.addEventListener("iron-form-submit",_this.defaultFormCallback.bind(_this))})}},{key:"_setLObj",value:function _setLObj(res,querySnapshot){if("data"in querySnapshot){var langs=querySnapshot.data();res.call(this,langs)}}},{key:"_setLang",value:function _setLang(res,lang){this.lang=lang;res.call(this);this._checkLabel()}},{key:"__changeLang",value:function __changeLang(){this.lang=this.translator.lang;this.translator.changeLang.call(this);this._checkLabel()}},{key:"defaultFormCallback",value:function defaultFormCallback(event){var _this2=this,obj=event.detail,formType=!!obj.formtype||!obj.formtype.match("undefined")?obj.formtype:"";if(!formType)return;Reflect.deleteProperty(obj,"formtype");var lang=!0/* skipSlots */===this.add?"lang":this.query.lang;try{Object.keys(obj).forEach(function(prop){return _this2[formType][0][lang][prop]=obj[prop]})}catch(err){throw err}}},{key:"_checkLabel",value:function _checkLabel(){if(!0===this.add){this.translator.changeItemTitleLang.call(this,"addPage","navLabel")}else{this.translator.changeItemTitleLang.call(this,"editPage","navLabel")}}},{key:"_checkIfClose",value:function _checkIfClose(data){if(!1===data&&!0===this.ctnOpened){this.$.closeanchor.click();this.ctnOpened=!1}}},{key:"_routePageChanged",value:function _routePageChanged(path,query){var _this3=this;if(!path){if(!!this.ctnOpened){this.ctnOpened=!1;setTimeout(function(){if(!!_this3.opened){_this3.hideThis();_this3.ctnOpened=!1}},500)}}if(!!path){this._reset();this.scrollTo(0,0);if(!!query.add){this.add="true"===query.add}if(!!query.added){this.added="true"===query.added}if(!!this.langs[this.lang])this._checkLabel();this.closestr="content/pages";if("/add-category-pages"===path||"/edit-category-pages"===path){if(!this.opened){this.showThis();this.ctnOpened=!0}if("/add-category-pages"===path){this._setAddedContent(query)}if("/edit-category-pages"===path){if(!!localStorage["page-".concat(query.content)]){this._setEditContent(query);return}}}else{this.ctnOpened=!1;this.hideThis()}}}},{key:"addImage",value:function addImage(){if(!1===this.add){localStorage["page-".concat(this.query.content)]=JSON.stringify(this.content);var string="type=page&content=".concat(this.query.content,"&lang=").concat(this.query.lang,"&add=").concat(this.add);window.history.pushState({},null,"".concat(this.rootPath,"media/galleries?").concat(string));window.dispatchEvent(new CustomEvent("location-changed"))}else{localStorage["page-new-content"]=JSON.stringify(this.content);var _string="type=page&content=new-content&lang=lang&add=".concat(this.add);window.history.pushState({},null,"".concat(this.rootPath,"media/galleries?").concat(_string));window.dispatchEvent(new CustomEvent("location-changed"))}window.onbeforeunload=function(e){return"you might have changes to be saved, are you sure you whant to leave?"}}},{key:"_setAddedContent",value:function _setAddedContent(){if(!0===this.add){var cont=JSON.parse(atob(Modelo));localStorage["page-new-content-info"]=atob(ModeloInfo);var obj=cont.images.content;this.imageLabel="images";this.set("imageArr",obj);this.set("str","content/pages/add-category-pages?content=pagenotsaved");this._setContent("lang",[cont]);this._getPageInfo("page-new-content-");this.set("pageLangs",[]);return}}},{key:"_setEditContent",value:function _setEditContent(query){var strg=location.search;strg=strg.split("lang=")[0];this.set("str","content/pages/edit-category-pages".concat(strg,"lang="));this.imageLabel="images";var arr,cont,images;this.set("imageArr",images);if(!1===this.add||!0===this.added){var _generateData$call=generateData.call(this,query),_generateData$call2=babelHelpers.slicedToArray(_generateData$call,3);arr=_generateData$call2[0];cont=_generateData$call2[1];images=_generateData$call2[2];this.set("imageArr",images);this._typeSellectedIndex=_getTypeIndex(this.inform,this.typesArray);if(!!query.lang){if("lang"!==query.lang)this.set("pageLangs",arr);this.__setLAng(query.lang,cont);this._sellectedLangIndex=_getLangIndex(this.pageLangs,query.lang)}}}},{key:"onSave",value:function onSave(){var data=new Date,inform;inform=this.inform.pop();var noLang=this._lastModified(this._setInfo(inform,data),data);if(!!noLang)return;if(!!this.removelang){this._removeLang();return 0}if(!!this.newlangstate)this.add=!0;this.savePages()}},{key:"_lastModified",value:function _lastModified(inform,data){if(!inform)return 1;if(!0===this.add)inform.lastModified.push({uid:this.user.uid,author:this.user.name,date:data.toLocaleString().replace(",","")});this.inform=[inform]}},{key:"_setInfo",value:function _setInfo(inform,data){if(!this.newlangstate){if(!0===this.add){if(!this.content[0].lang.lang&&!this.content[0].lang.categoryName){alert("insert Lang & Category Name first");return void 0}this.content[0][this.content[0].lang.lang]=this.content[0].lang;inform.id=this.content[0][this.content[0].lang.lang].categoryName.toLowerCase();inform.ref=btoa(this.content[0][this.content[0].lang.lang].categoryName).split("").map(function(item){return item.charCodeAt().toString(16)}).join("");inform.type=this.content[0][this.content[0].lang.lang].type;delete this.content[0].lang;inform.Published.date="NP";inform.Published.publishedBy="N/A";inform.Published.state="NP";inform.author.id=this.user.uid;inform.author.name=this.user.name;inform.path=inform.id;inform.toArticle="B";inform.removed=!1;inform.dateCreated=data.toLocaleString().replace(",","")}else{if(""===inform.type)inform.type=this.content[0][this.setContetnLang].type}}return inform}},{key:"_reset",value:function _reset(){this.imageLabel="";this.set("content",[]);this.set("imageArr",[]);this.set("inform",[]);this.set("inputVal",[]);this.set("textareaVal",[])}}],[{key:"_getSideInfo",get:function get(){return(0,_cmsLogin.html)(_templateObject_77ef8f30615e11eab834b97a903770ac())}},{key:"is",get:function get(){return"cms-page-cats-content"}},{key:"properties",get:function get(){return{user:{type:Object},inputVal:{type:Array,notify:!0,value:[]},textarea:{type:Boolean,value:!0,notify:!0},textareaVal:{type:String,notify:!0,value:""},imageArr:{type:Array,notify:!0,value:[]},translator:{type:Object,notify:!0,value:function value(){return MyAppGlobals[window.cms];//MyAppGlobals.translator
}},lang:{type:String,notify:!0,value:""},langs:{type:Object,value:{}},ctnOpened:{type:Boolean,notify:!0},opened:{type:Boolean,notify:!0,observer:"_checkIfClose"},getdown:{type:Boolean,reflectToAttribute:!0,notify:!0,value:!1},addLangResponse:{type:Object,notify:!0,value:{},observer:"_setAddLangValue"},inputResponse:{type:Object,notify:!0,value:{},observer:"_setItemsValue"},textAreaResponse:{type:Object,notify:!0,value:{},observer:"_setContentTextValue"},typesArray:{type:Array,value:["home","portfolio","blog","services","profile","social","about"]},content:{type:Object,notify:!0,value:{}},langStr:String,time:Number,_typeSellectedIndex:{type:Number,notify:!0},_sellectedLangIndex:{type:Number,notify:!0}}}},{key:"observers",get:function get(){return["_routePageChanged(route.path, query)"]}}]);return cmsPageCatsContent}((0,_cmsLogin.cmsPagesLib)(_cmsLogin.cmsContentTemplate));customElements.define(cmsPageCatsContent.is,cmsPageCatsContent);function generateData(query){var cont;return regeneratorRuntime.wrap(function generateData$(_context){while(1){switch(_context.prev=_context.next){case 0:cont=JSON.parse(localStorage["page-".concat(query.content)]);_context.next=3;return this._setLangArr(cont[0]);case 3:_context.next=5;return cont;case 5:this._getPageInfo("page-".concat(query.content,"-"));_context.next=8;return cont[0].images.content;case 8:case"end":return _context.stop();}}},_marked,this)}function _getTypeIndex(details,typesArray){return typesArray.findIndex(function(item){return item===details[0].type})}function _getLangIndex(pageLangs,lang){return pageLangs.findIndex(function(item){return item===lang})}});