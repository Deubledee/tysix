{
  "_args": [
    [
      "polymer-build@https://registry.npmjs.org/polymer-build/-/polymer-build-3.1.0.tgz",
      "/home/diogo/www/node_modules/polymer-cli"
    ]
  ],
  "_from": "polymer-build@https://registry.npmjs.org/polymer-build/-/polymer-build-3.1.0.tgz",
  "_id": "polymer-build@3.1.0",
  "_inCache": true,
  "_location": "/polymer-cli/polymer-build",
  "_phantomChildren": {
    "@types/events": "1.2.0",
    "@types/glob-stream": "6.1.0",
    "@types/node": "10.12.0",
    "@types/vinyl": "2.0.2",
    "diagnostics": "1.1.1",
    "is-stream": "1.1.0",
    "lodash": "4.17.11",
    "logform": "1.10.0",
    "one-time": "0.0.4",
    "readable-stream": "2.3.6",
    "stack-trace": "0.0.10",
    "triple-beam": "1.3.0",
    "winston-transport": "4.2.0"
  },
  "_requested": {
    "name": "polymer-build",
    "raw": "polymer-build@https://registry.npmjs.org/polymer-build/-/polymer-build-3.1.0.tgz",
    "rawSpec": "https://registry.npmjs.org/polymer-build/-/polymer-build-3.1.0.tgz",
    "scope": null,
    "spec": "https://registry.npmjs.org/polymer-build/-/polymer-build-3.1.0.tgz",
    "type": "remote"
  },
  "_requiredBy": [
    "/polymer-cli",
    "/polymer-cli/polyserve"
  ],
  "_resolved": "https://registry.npmjs.org/polymer-build/-/polymer-build-3.1.0.tgz",
  "_shasum": "13534ac3c68f59f4acf5d6947e3f7acbf41eb0bf",
  "_shrinkwrap": null,
  "_spec": "polymer-build@https://registry.npmjs.org/polymer-build/-/polymer-build-3.1.0.tgz",
  "_where": "/home/diogo/www/node_modules/polymer-cli",
  "author": {
    "name": "The Polymer Project Authors"
  },
  "bugs": {
    "url": "https://github.com/Polymer/tools/issues"
  },
  "dependencies": {
    "@babel/core": "^7.0.0",
    "@babel/plugin-external-helpers": "^7.0.0",
    "@babel/plugin-proposal-async-generator-functions": "^7.0.0",
    "@babel/plugin-proposal-object-rest-spread": "^7.0.0",
    "@babel/plugin-syntax-async-generators": "^7.0.0",
    "@babel/plugin-syntax-dynamic-import": "^7.0.0",
    "@babel/plugin-syntax-import-meta": "^7.0.0",
    "@babel/plugin-syntax-object-rest-spread": "^7.0.0",
    "@babel/plugin-transform-arrow-functions": "^7.0.0",
    "@babel/plugin-transform-async-to-generator": "^7.0.0",
    "@babel/plugin-transform-block-scoped-functions": "^7.0.0",
    "@babel/plugin-transform-block-scoping": "^7.0.0",
    "@babel/plugin-transform-classes": "^7.0.0",
    "@babel/plugin-transform-computed-properties": "^7.0.0",
    "@babel/plugin-transform-destructuring": "^7.0.0",
    "@babel/plugin-transform-duplicate-keys": "^7.0.0",
    "@babel/plugin-transform-exponentiation-operator": "^7.0.0",
    "@babel/plugin-transform-for-of": "^7.0.0",
    "@babel/plugin-transform-function-name": "^7.0.0",
    "@babel/plugin-transform-instanceof": "^7.0.0",
    "@babel/plugin-transform-literals": "^7.0.0",
    "@babel/plugin-transform-modules-amd": "^7.0.0",
    "@babel/plugin-transform-object-super": "^7.0.0",
    "@babel/plugin-transform-parameters": "^7.0.0",
    "@babel/plugin-transform-regenerator": "^7.0.0",
    "@babel/plugin-transform-shorthand-properties": "^7.0.0",
    "@babel/plugin-transform-spread": "^7.0.0",
    "@babel/plugin-transform-sticky-regex": "^7.0.0",
    "@babel/plugin-transform-template-literals": "^7.0.0",
    "@babel/plugin-transform-typeof-symbol": "^7.0.0",
    "@babel/plugin-transform-unicode-regex": "^7.0.0",
    "@babel/traverse": "^7.0.0",
    "@polymer/esm-amd-loader": "^1.0.0",
    "@types/babel-types": "^6.25.1",
    "@types/babylon": "^6.16.2",
    "@types/gulp-if": "0.0.33",
    "@types/html-minifier": "^3.5.1",
    "@types/is-windows": "^0.2.0",
    "@types/mz": "0.0.31",
    "@types/parse5": "^2.2.34",
    "@types/resolve": "0.0.7",
    "@types/uuid": "^3.4.3",
    "@types/vinyl": "^2.0.0",
    "@types/vinyl-fs": "^2.4.8",
    "babel-plugin-minify-guarded-expressions": "=0.4.1",
    "babel-preset-minify": "=0.4.0-alpha.caaefb4c",
    "babylon": "^7.0.0-beta.42",
    "css-slam": "^2.1.2",
    "dom5": "^3.0.0",
    "gulp-if": "^2.0.2",
    "html-minifier": "^3.5.10",
    "matcher": "^1.1.0",
    "multipipe": "^1.0.2",
    "mz": "^2.6.0",
    "parse5": "^4.0.0",
    "plylog": "^1.0.0",
    "polymer-analyzer": "^3.1.3",
    "polymer-bundler": "^4.0.3",
    "polymer-project-config": "^4.0.0",
    "regenerator-runtime": "^0.11.1",
    "stream": "0.0.2",
    "sw-precache": "^5.1.1",
    "uuid": "^3.2.1",
    "vinyl": "^1.2.0",
    "vinyl-fs": "^2.4.4"
  },
  "description": "A library of Gulp build tasks",
  "devDependencies": {
    "@types/fs-extra": "0.0.37",
    "@types/sinon": "^5.0.0",
    "depcheck": "^0.6.3",
    "fs-extra": "^5.0.0",
    "istanbul": "^0.4.5",
    "merge-stream": "^1.0.1",
    "sinon": "^5.0.7",
    "source-map-support": "^0.5.4",
    "strip-indent": "^2.0.0",
    "temp": "^0.8.3",
    "tsc-then": "^1.1.0"
  },
  "homepage": "https://github.com/Polymer/tools/tree/master/packages/build",
  "license": "BSD-3-Clause",
  "main": "lib/polymer-build.js",
  "name": "polymer-build",
  "optionalDependencies": {},
  "readme": "[![Build Status](https://travis-ci.org/Polymer/polymer-build.svg?branch=master)](https://travis-ci.org/Polymer/polymer-build)\n[![NPM version](http://img.shields.io/npm/v/polymer-build.svg)](https://www.npmjs.com/package/polymer-build)\n\n# Polymer Build\n\npolymer-build is a library for building Polymer projects.\n\n\n## Installation\n\n```\nnpm install --save-dev polymer-build\n```\n\n\n## Relationship to Polymer CLI\n\nThe [Polymer CLI](https://github.com/Polymer/polymer-cli) uses polymer-build under the hood, so you can think of the CLI's `build` command like running a pre-configured polymer-build pipeline. Setting this up for you makes the CLI easy to use, but as a command-line wrapper its customization options are more limited. polymer-build allows you to completely customize your build and combine additional streams and build tasks in any order.\n\nConsider using polymer-build instead of the CLI if you:\n\n- Want to customize your build(s) without using the Polymer CLI\n- Need to run your source code through custom optimizers/processors before, after, or during your build\n- Need to hook additional work into any part of the build process\n\n\n## Usage\n\nWhile polymer-build was built to work easily with Gulp, it can be used in any Node.js environment. polymer-build is built on Node.js streams, and the build pipeline that you create with it is not much more than a series of connected streams. Files are represented as [Vinyl](https://github.com/gulpjs/vinyl) file objects, which means that polymer-build can interop with any existing Gulp/Vinyl streams.\n\nCheck out the [custom-build generator](https://github.com/PolymerElements/generator-polymer-init-custom-build) for an example of how polymer-build can be used to build a project.\n\n\n### PolymerProject\n\n`PolymerProject` represents your project in the build pipeline. Once configured, it will give you access to a collection of streams and helpers for building your project.\n\nTo create a new instance of `PolymerProject`, you'll need to give it some information about your application. If you already have a [`polymer.json`](https://www.polymer-project.org/2.0/docs/tools/polymer-json) configuration file in your project, you can create a new `PolymerProject` instance by loading it directly:\n\n```js\nconst PolymerProject = require('polymer-build').PolymerProject;\n\nconst project = new PolymerProject(require('./polymer.json'));\n```\n\nOr, you can pass in configuration options directly to the `PolymerProject` constructor:\n\n```js\nconst PolymerProject = require('polymer-build').PolymerProject;\n\nconst project = new PolymerProject({\n  entrypoint: 'index.html',\n  shell: 'src/my-app.js',\n  fragments: [\n    'src/my-view1.js',\n    'src/my-view2.js',\n    'src/my-view3.js'\n  ]\n});\n```\n\n#### project.sources()\n\nReturns a readable stream of your project's source files. By default, these are the files in your project's `src/` directory, but if you have additional source files this can be configured via the `sources` property in [`ProjectOptions`](src/polymer-project.ts).\n\n#### project.dependencies()\n\nReturns a readable stream of your project's dependencies. This stream is automatically populated based on the files loaded inside of your project. You can include additional dependencies via the `extraDependencies` property in [`ProjectOptions`](src/polymer-project.ts) (this can be useful when the analyzer fails to detect a necessary dependency.)\n\n```js\nconst gulp = require('gulp');\nconst mergeStream = require('merge-stream');\n\n// Create a build pipeline to pipe both streams together to the 'build/' dir\nmergeStream(project.sources(), project.dependencies())\n  .pipe(gulp.dest('build/'));\n```\n\n\n### Handling Inlined CSS/JS\n\n#### HtmlSplitter\n\nWeb components will sometimes include inlined CSS & JavaScript. This can pose a problem for tools that weren't built to read those languages from inside HTML. To solve this, you can create an `HtmlSplitter` instance to extract inlined CSS & JavaScript into individual files in your build stream for processing (and then rejoin them later).\n\n```js\nconst gulpif = require('gulp-if');\nconst uglify = require('gulp-uglify');\nconst cssSlam = require('css-slam').gulp;\nconst htmlMinifier = require('gulp-html-minifier');\nconst HtmlSplitter = require('polymer-build').HtmlSplitter;\n\nconst sourcesHtmlSplitter = new HtmlSplitter();\nconst sourcesStream = project.sources()\n  .pipe(sourcesHtmlSplitter.split()) // split inline JS & CSS out into individual .js & .css files\n  .pipe(gulpif(/\\.js$/, uglify()))\n  .pipe(gulpif(/\\.css$/, cssSlam()))\n  .pipe(gulpif(/\\.html$/, htmlMinifier()))\n  .pipe(sourcesHtmlSplitter.rejoin()); // rejoins those files back into their original location\n\n// NOTE: If you want to split/rejoin your dependencies stream as well, you'll need to create a new HtmlSplitter for that stream.\n```\n\nYou can add splitters to any part of your build stream. We recommend using them to optimize your `sources()` and `dependencies()` streams individually as in the example above, but you can also optimize after merging the two together or even after bundling.\n\n\n### Bundling Files\n\n#### project.bundler()\n\nA stream that combines seperate files into code bundles based on your application's dependency graph. This can be a great way to [improve performance](https://developer.yahoo.com/performance/rules.html#num_http) by reducing the number of frontend requests needed.\n\nBy default, the bundler will create one \"shared-bundle.html\" containing all shared dependencies. You can optimize even further by defining \"fragments\" in your project options. Fragments are lazy loaded parts of the application, typically views and other elements loaded on-demand. When fragments are defined, the bundler is able to create smaller bundles containing code that is only required for specific fragments.\n\n```js\nconst gulp = require('gulp');\nconst mergeStream = require('merge-stream');\n\n// Create a build pipeline to bundle our application before writing to the 'build/' dir\nmergeStream(project.sources(), project.dependencies())\n  .pipe(project.bundler())\n  .pipe(gulp.dest('build/'));\n```\n\nThe bundler() method accepts an options object to configure bundling.  See [Using polymer-bundler programmatically](https://github.com/Polymer/tools/tree/master/packages/bundler#using-polymer-bundler-programmatically) for a detailed list of accepted options.\n\n```js\nconst {generateCountingSharedBundleUrlMapper,\n       generateSharedDepsMergeStrategy} = require('polymer-bundler');\n\nmergeStream(project.sources(), project.dependencies())\n  .pipe(project.bundler({\n    excludes: ['bower_components/polymer-code-mirror'],\n    sourcemaps: true,\n    stripComments: true,\n    strategy: generateSharedDepsMergeStrategy(3),\n    urlMapper: generateCountingSharedBundleUrlMapper('shared/bundle_')\n  }))\n  .pipe(gulp.dest('build/'));\n```\n\nNOTE: When working programmatically with Bundler, **Polymer 1.x** projects should include `rewriteUrlsInTemplates: true` when their projects rely on custom element definitions which use relative paths inside style tags and element attributes.  **Polymer 2.x** uses the `assetpath` property added to dom-modules during bundling to resolve relative urls in style tags and provides the [importPath](https://www.polymer-project.org/2.0/docs/devguide/dom-template#urls-in-templates) binding to prefix relative paths in templates.\n\n### Generating a Service Worker\n\n#### generateServiceWorker()\n\n`generateServiceWorker()` will generate the service worker code based on your build. Unlike other parts of polymer-build, `generateServiceWorker()` returns a promise and not a stream. It can only be run **after** your build has finished writing to disk, so that it is able to analyze the entire build as it exists.\n\nFor bundled builds, be sure to set the bundled option to `true`. See [AddServiceWorkerOptions](src/service-worker.ts) for a list of all supported options.\n\n```js\nconst generateServiceWorker = require('polymer-build').generateServiceWorker;\n\ngenerateServiceWorker({\n  buildRoot: 'build/',\n  project: project,\n  bundled: true, // set if `project.bundler()` was used\n  swPrecacheConfig: {\n    // See https://github.com/GoogleChrome/sw-precache#options-parameter for all supported options\n    navigateFallback: '/index.html',\n  }\n}).then(() => { // ...\n```\n\n`generateServiceWorker()` is built on top of the [sw-precache](https://github.com/GoogleChrome/sw-precache) library. Any options it supports can be passed directly to that library via the `swPrecacheConfig` option. See [sw-preache](https://github.com/GoogleChrome/sw-precache#options-parameter) for a list of all supported options\n\nIn some cases you may need to whitelist 3rd party services with sw-precache, so the Service Worker doesn't intercept them. For instance, if you're hosting your app on Firebase, you'll want to add the `navigateFallbackWhitelist: [/^(?!\\/__)/]` option to your `swPrecacheConfig` as Firebase owns the `__` namespace, and intercepting it will cause things like OAuth to fail.\n\n#### addServiceWorker()\n\nLike `generateServiceWorker()`, but writes the generated service worker to the file path you specify in the `path` option (\"service-worker.js\" by default).\n\n```js\nconst addServiceWorker = require('polymer-build').addServiceWorker;\n\naddServiceWorker({\n  buildRoot: 'build/',\n  project: project,\n}).then(() => { // ...\n```\n\n\n### Generating an HTTP/2 Push Manifest\n\n`polymer-build` can automatically generate a [push manifest](https://github.com/GoogleChrome/http2-push-manifest) for your application. This JSON file can be read by any HTTP/2 push-enabled web server to more easily construct the appropriate `Link: <URL>; rel=preload; as=<TYPE>` headers(s) for HTTP/2 push/preload. Check out [http2push-gae](https://github.com/GoogleChrome/http2push-gae) for an example Google Apps Engine server that supports this.\n\nThe generated push manifest describes the following behavior: Requesting the shell should push any shell dependencies as well. Requesting a fragment should push any dependencies of that fragment *that were not already pushed by the shell.* If no shell was defined for your build, `polymer-build` will use the application entrypoint URL instead (default: `index.html`).\n\n\n#### project.addPushManifest()\n\nThis method will return a transform stream that injects a new push manifest into your build (default: `push-manifest.json`). The push manifest is based off the application import graph, so make sure that this stream is added after all changes to the application source code.\n\nUse the `filePath` argument to configure the name of the generated file (relative to your application root).\n\nUse the `prefix` argument to prepend a string to all resource paths in the generated manifest. This can\nbe useful when a build is going to be served from a sub-directory on the server.\n\n```js\nconst gulp = require('gulp');\nconst mergeStream = require('merge-stream');\n\nmergeStream(project.sources(), project.dependencies())\n  .pipe(project.addPushManifest())\n  .pipe(gulp.dest('build/'));\n```\n\n### Custom Elements ES5 Adapter\n\nIf your build pipeline outputs ES5 custom elements (either from source or by compilation with a tool like Babel), it is critical to include the [Custom Elements ES5 Adapter](https://github.com/webcomponents/custom-elements/blob/master/src/native-shim.js). This adapter provides compatibility between custom elements defined as ES5-style classes and browsers with native implementations of the Custom Elements API, such as Chrome. See the [adapter documentation](https://github.com/webcomponents/custom-elements/blob/master/src/native-shim.js) for details of why this is necessary.\n\n#### project.addCustomElementsEs5Adapter()\n\nThis method will return a transform stream that identifies your entrypoint HTML file (by looking for a webcomponents polyfill import) and injects a block of HTML that loads the Custom Elements ES5 Adapter. You can use this in a build pipeline to conditionally inject the adapter only when you output ES5 (as it is not needed when you output ES6).\n\n```js\nconst gulp = require('gulp');\nconst mergeStream = require('merge-stream');\n\nmergeStream(project.sources(), project.dependencies())\n  .pipe(project.addCustomElementsEs5Adapter())\n  .pipe(gulp.dest('build/'));\n```\n\n\n### Multiple Builds\n\n#### forkStream(stream)\n\nSometimes you'll want to pipe a build to multiple destinations. `forkStream()` creates a new stream that copies the original stream, cloning all files that pass through it.\n\n```js\nconst gulp = require('gulp');\nconst mergeStream = require('merge-stream');\nconst forkStream = require('polymer-build').forkStream;\n\n// Create a combined build stream of your application files\nconst buildStream = mergeStream(project.sources(), project.dependencies());\n\n// Fork your build stream to write directly to the 'build/unbundled' dir\nconst unbundledBuildStream = forkStream(buildStream)\n  .pipe(gulp.dest('build/unbundled'));\n\n// Fork your build stream to bundle your application and write to the 'build/bundled' dir\nconst bundledBuildStream = forkStream(buildStream)\n  .pipe(project.bundler())\n  .pipe(gulp.dest('build/bundled'));\n```\n\n#### project.updateBaseTag()\n\nThis method will return a transform stream that finds a `<base>` tag in your configured entrypoint HTML file, and updates it with the specified value. This can be useful when multiple builds are served each from their own sub-directory on the same host, in conjunction with a convention of using relative URLs for static resources. Your entrypoint must already contain a `<base href=\"/\">` or similar tag in its `<head>`, before any imports.\n\nNote that *only the entrypoint will be updated*. Fragments with `<base>` tags will not be modified. Fragments should typically use relative URLs to refer to other artifacts in the build, so that they are agnostic to their serving path. The entrypoint gets special treatment here because it is typically served from paths that do not correspond to its location relative to other build artifacts.\n\n```js\nconst gulp = require('gulp');\nconst mergeStream = require('merge-stream');\nconst forkStream = require('polymer-build').forkStream;\n\nconst buildStream = mergeStream(project.sources(), project.dependencies());\n\nconst unbundledBuildStream = forkStream(buildStream)\n  // This build will be served from http://example.com/unbundled/\n  .pipe(project.updateBaseTag('/unbundled/'))\n  .pipe(gulp.dest('build/unbundled'));\n\nconst bundledBuildStream = forkStream(buildStream)\n  .pipe(project.bundler())\n  // While this build will be served from http://example.com/bundled/\n  .pipe(project.updateBaseTag('/bundled/'))\n  .pipe(gulp.dest('build/bundled'));\n```\n\n\n## Contributing\n\n1. Fork it!\n2. Create your feature branch: `git checkout -b my-new-feature`\n3. Commit your changes: `git commit -am 'Add some feature'`\n4. Push to the branch: `git push origin my-new-feature`\n5. Submit a pull request :D\n\nYou can compile polymer-build from source by cloning the repo and then running `npm run build`. Make sure you have already run `npm install` before compiling.\n\n\n## Supported Node.js Versions\n\npolymer-build officially supports the latest current & active [LTS](https://github.com/nodejs/LTS) versions of Node.js. See our [.travis.yml](/.travis.yml) for the current versions of Node.js under test and visit the [Polymer Tools Node.js Support Policy](https://www.polymer-project.org/2.0/docs/tools/node-support) for more information.\n",
  "readmeFilename": "README.md",
  "repository": {
    "type": "git",
    "url": "git+https://github.com/polymer/tools.git"
  },
  "scripts": {
    "build": "npm run clean && tsc && node scripts/generate-helpers.js && npm run lint",
    "clean": "rm -rf lib/",
    "format": "find src -name \"*.ts\" | xargs clang-format --style=file -i",
    "lint": "tslint -p . && node scripts/depcheck.js",
    "prepublishOnly": "npm test",
    "test": "npm run build && npm run lint && mocha \"lib/test/**/*_test.js\"",
    "test:unit": "mocha \"lib/test/**/*_test.js\"",
    "test:watch": "tsc-then -- mocha \"lib/test/**/*_test.js\""
  },
  "typings": "lib/polymer-build.d.ts",
  "version": "3.1.0"
}
